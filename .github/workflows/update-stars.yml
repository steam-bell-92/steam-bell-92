name: Update Star Count

on:
  schedule:
    - cron: '*/10 * * * *'  # runs every 10 minutes
  workflow_dispatch:        # allows manual trigger

jobs:
  update-readme:
    runs-on: ubuntu-latest
    steps:
      # 1. Checkout your repo
      - name: Checkout
        uses: actions/checkout@v3

      # 2. Fetch star count via GitHub API
      - name: Get Star Count
        id: stars
        run: |
          STAR_COUNT=$(curl -s https://api.github.com/users/steam-bell-92 | jq '.public_repos')
          echo "STAR_COUNT=$STAR_COUNT" >> $GITHUB_ENV

      # 3. Update README.md badge or text
      - name: Update README
        run: |
          # Replace the line containing "Star Gazers:" with the new count
          sed -i "s/Star Gazers: [0-9]\+/Star Gazers: $STAR_COUNT/" README.md

      # 4. Commit and push changes
      - name: Commit & Push
        run: |
          git config --global user.name "github-actions[bot]"
          git config --global user.email "github-actions[bot]@users.noreply.github.com"
          git add README.md
          git commit -m "Update star count"
          git push
